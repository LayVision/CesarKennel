<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- SEO: noindex tag prevents search engines from indexing this admin page -->
    <meta name="robots" content="noindex, nofollow">
    <title>แผงควบคุมสำหรับผู้ดูแล</title>
    <link rel="stylesheet" href="admin-style.css">
</head>
<body>
    <!-- Centered container for the login form -->
    <div class="login-container">
        <!-- The login form itself -->
        <form id="login-form" class="login-form">
            <h2>ผู้ดูแลระบบ</h2>
            <div class="input-group">
                <label for="username">อีเมล</label>
                <input type="email" id="username" name="username" required>
            </div>
            <div class="input-group">
                <label for="password">รหัสผ่าน</label>
                <input type="password" id="password" name="password" required>
            </div>
            <button type="submit" class="button button-primary">เข้าสู่ระบบ</button>
            <p class="home-link"><a href="index.html">กลับสู่หน้าหลัก</a></p>
        </form>
    </div>

    <!-- Firebase SDKs for authentication -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js";

        // Firebase configuration object
        const firebaseConfig = {
            apiKey: "AIzaSyA85L7n2CGKocgWg-Z8TsNlUN9AVVJguBQ",
            authDomain: "cesarkennel.firebaseapp.com",
            projectId: "cesarkennel",
            storageBucket: "cesarkennel.firebasestorage.app",
            messagingSenderId: "512752480416",
            appId: "1:512752480416:web:c71aa9dc281a3932b419c5"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // --- Authentication State Observer ---
        // If a user is already logged in, redirect them directly to the admin panel.
        onAuthStateChanged(auth, (user) => {
            if (user) {
                window.location.href = 'admin.html';
            }
        });

        // --- Login Form Logic ---
        const loginForm = document.getElementById('login-form');
        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const email = loginForm.username.value;
            const password = loginForm.password.value;
            const button = loginForm.querySelector('button');
            
            // Disable button to prevent multiple submissions
            button.disabled = true;
            button.textContent = 'กำลังเข้าสู่ระบบ...';

            // Attempt to sign in with Firebase Authentication
            signInWithEmailAndPassword(auth, email, password)
                .then((userCredential) => {
                    // Success! The onAuthStateChanged observer will handle the redirect.
                    window.location.href = 'admin.html';
                })
                .catch((error) => {
                    // Handle login errors (e.g., wrong password)
                    console.error("Login Error:", error.message);
                    alert('อีเมลหรือรหัสผ่านไม่ถูกต้อง');
                    // Re-enable the button
                    button.disabled = false;
                    button.textContent = 'เข้าสู่ระบบ';
                });
        });
    </script>
</body>
</html>